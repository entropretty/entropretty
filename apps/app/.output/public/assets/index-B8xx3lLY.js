import{c as y,j as a,r as u,u as q,s as X,t as B}from"./main-D_QOtJ75.js";import{S as V,B as $}from"./button-BnWcWO71.js";import{F as G,C as J,a as K,L as Q,t as U,o as Z,u as ee,e as te,s as ne}from"./label-CqcMyrRf.js";import{c as _}from"./utils-CjfV1Qjd.js";import{u as re}from"./useMutation-DYqESHb7.js";import{c as z}from"./createLucideIcon-4ydf6LMZ.js";import{m as R,A as se}from"./proxy-zRc3mXX4.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],ie=z("frown",oe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ae=z("loader-circle",le);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],de=z("meh",ce);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],ue=z("smile",me),fe=G,D=u.createContext({}),H=n=>{const t=y.c(9);let e;t[0]!==n?({...e}=n,t[0]=n,t[1]=e):e=t[1];let r;t[2]!==e.name?(r={name:e.name},t[2]=e.name,t[3]=r):r=t[3];let o;t[4]!==e?(o=a.jsx(J,{...e}),t[4]=e,t[5]=o):o=t[5];let i;return t[6]!==r||t[7]!==o?(i=a.jsx(D.Provider,{value:r,children:o}),t[6]=r,t[7]=o,t[8]=i):i=t[8],i},I=()=>{const n=y.c(11),t=u.useContext(D),e=u.useContext(A),{getFieldState:r,formState:o}=K();let i;n[0]!==t.name||n[1]!==o||n[2]!==r?(i=r(t.name,o),n[0]=t.name,n[1]=o,n[2]=r,n[3]=i):i=n[3];const l=i;if(!t)throw new Error("useFormField should be used within <FormField>");const{id:s}=e,d=`${s}-form-item`,c=`${s}-form-item-description`,m=`${s}-form-item-message`;let x;return n[4]!==t.name||n[5]!==l||n[6]!==s||n[7]!==d||n[8]!==c||n[9]!==m?(x={id:s,name:t.name,formItemId:d,formDescriptionId:c,formMessageId:m,...l},n[4]=t.name,n[5]=l,n[6]=s,n[7]=d,n[8]=c,n[9]=m,n[10]=x):x=n[10],x},A=u.createContext({}),M=u.forwardRef((n,t)=>{const e=y.c(14);let r,o;e[0]!==n?({className:r,...o}=n,e[0]=n,e[1]=r,e[2]=o):(r=e[1],o=e[2]);const i=u.useId();let l;e[3]!==i?(l={id:i},e[3]=i,e[4]=l):l=e[4];let s;e[5]!==r?(s=_("space-y-2",r),e[5]=r,e[6]=s):s=e[6];let d;e[7]!==o||e[8]!==t||e[9]!==s?(d=a.jsx("div",{ref:t,className:s,...o}),e[7]=o,e[8]=t,e[9]=s,e[10]=d):d=e[10];let c;return e[11]!==l||e[12]!==d?(c=a.jsx(A.Provider,{value:l,children:d}),e[11]=l,e[12]=d,e[13]=c):c=e[13],c});M.displayName="FormItem";const pe=u.forwardRef((n,t)=>{const e=y.c(11);let r,o;e[0]!==n?({className:r,...o}=n,e[0]=n,e[1]=r,e[2]=o):(r=e[1],o=e[2]);const{error:i,formItemId:l}=I(),s=i&&"text-destructive";let d;e[3]!==r||e[4]!==s?(d=_(s,r),e[3]=r,e[4]=s,e[5]=d):d=e[5];let c;return e[6]!==l||e[7]!==o||e[8]!==t||e[9]!==d?(c=a.jsx(Q,{ref:t,className:d,htmlFor:l,...o}),e[6]=l,e[7]=o,e[8]=t,e[9]=d,e[10]=c):c=e[10],c});pe.displayName="FormLabel";const T=u.forwardRef((n,t)=>{const e=y.c(8);let r;e[0]!==n?({...r}=n,e[0]=n,e[1]=r):r=e[1];const{error:o,formItemId:i,formDescriptionId:l,formMessageId:s}=I(),d=o?`${l} ${s}`:`${l}`,c=!!o;let m;return e[2]!==i||e[3]!==r||e[4]!==t||e[5]!==d||e[6]!==c?(m=a.jsx(V,{ref:t,id:i,"aria-describedby":d,"aria-invalid":c,...r}),e[2]=i,e[3]=r,e[4]=t,e[5]=d,e[6]=c,e[7]=m):m=e[7],m});T.displayName="FormControl";const xe=u.forwardRef((n,t)=>{const e=y.c(10);let r,o;e[0]!==n?({className:r,...o}=n,e[0]=n,e[1]=r,e[2]=o):(r=e[1],o=e[2]);const{formDescriptionId:i}=I();let l;e[3]!==r?(l=_("text-[0.8rem] text-muted-foreground",r),e[3]=r,e[4]=l):l=e[4];let s;return e[5]!==i||e[6]!==o||e[7]!==t||e[8]!==l?(s=a.jsx("p",{ref:t,id:i,className:l,...o}),e[5]=i,e[6]=o,e[7]=t,e[8]=l,e[9]=s):s=e[9],s});xe.displayName="FormDescription";const O=u.forwardRef((n,t)=>{const e=y.c(12);let r,o,i;e[0]!==n?({className:o,children:r,...i}=n,e[0]=n,e[1]=r,e[2]=o,e[3]=i):(r=e[1],o=e[2],i=e[3]);const{error:l,formMessageId:s}=I(),d=l?String(l?.message):r;if(!d)return null;let c;e[4]!==o?(c=_("text-[0.8rem] font-medium text-destructive",o),e[4]=o,e[5]=c):c=e[5];let m;return e[6]!==d||e[7]!==s||e[8]!==i||e[9]!==t||e[10]!==c?(m=a.jsx("p",{ref:t,id:s,className:c,...i,children:d}),e[6]=d,e[7]=s,e[8]=i,e[9]=t,e[10]=c,e[11]=m):m=e[11],m});O.displayName="FormMessage";const W=u.forwardRef((n,t)=>{const e=y.c(9);let r,o;e[0]!==n?({className:r,...o}=n,e[0]=n,e[1]=r,e[2]=o):(r=e[1],o=e[2]);let i;e[3]!==r?(i=_("border-input placeholder:text-muted-foreground focus-visible:ring-ring flex min-h-[60px] w-full border bg-transparent px-3 py-2 text-base shadow-sm focus-visible:outline-none focus-visible:ring-1 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),e[3]=r,e[4]=i):i=e[4];let l;return e[5]!==o||e[6]!==t||e[7]!==i?(l=a.jsx("textarea",{className:i,ref:t,...o}),e[5]=o,e[6]=t,e[7]=i,e[8]=l):l=e[8],l});W.displayName="Textarea";function P(n,t){let e;return(...r)=>{window.clearTimeout(e),e=window.setTimeout(()=>n(...r),t)}}function he({debounce:n,scroll:t,polyfill:e,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const o=e||(typeof window>"u"?class{}:window.ResizeObserver);if(!o)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[i,l]=u.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),s=u.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:i,orientationHandler:null}),d=n?typeof n=="number"?n:n.scroll:null,c=n?typeof n=="number"?n:n.resize:null,m=u.useRef(!1);u.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[x,b,p]=u.useMemo(()=>{const f=()=>{if(!s.current.element)return;const{left:g,top:w,width:C,height:j,bottom:F,right:k,x:L,y:S}=s.current.element.getBoundingClientRect(),N={left:g,top:w,width:C,height:j,bottom:F,right:k,x:L,y:S};s.current.element instanceof HTMLElement&&r&&(N.height=s.current.element.offsetHeight,N.width=s.current.element.offsetWidth),Object.freeze(N),m.current&&!ge(s.current.lastBounds,N)&&l(s.current.lastBounds=N)};return[f,c?P(f,c):f,d?P(f,d):f]},[l,r,d,c]);function v(){s.current.scrollContainers&&(s.current.scrollContainers.forEach(f=>f.removeEventListener("scroll",p,!0)),s.current.scrollContainers=null),s.current.resizeObserver&&(s.current.resizeObserver.disconnect(),s.current.resizeObserver=null),s.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",s.current.orientationHandler))}function h(){s.current.element&&(s.current.resizeObserver=new o(p),s.current.resizeObserver.observe(s.current.element),t&&s.current.scrollContainers&&s.current.scrollContainers.forEach(f=>f.addEventListener("scroll",p,{capture:!0,passive:!0})),s.current.orientationHandler=()=>{p()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",s.current.orientationHandler))}const E=f=>{!f||f===s.current.element||(v(),s.current.element=f,s.current.scrollContainers=Y(f),h())};return ye(p,!!t),be(b),u.useEffect(()=>{v(),h()},[t,p,b]),u.useEffect(()=>v,[]),[E,i,x]}function be(n){u.useEffect(()=>{const t=n;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[n])}function ye(n,t){u.useEffect(()=>{if(t){const e=n;return window.addEventListener("scroll",e,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",e,!0)}},[n,t])}function Y(n){const t=[];if(!n||n===document.body)return t;const{overflow:e,overflowX:r,overflowY:o}=window.getComputedStyle(n);return[e,r,o].some(i=>i==="auto"||i==="scroll")&&t.push(n),[...t,...Y(n.parentElement)]}const ve=["x","y","top","bottom","left","right","width","height"],ge=(n,t)=>ve.every(e=>n[e]===t[e]),we=Z({feedback:ne().min(1,"Please provide some feedback"),sentiment:te(["negative","neutral","positive"],{required_error:"Please select a sentiment"})}),je={negative:-1,neutral:0,positive:1};function Ie(n){const t=y.c(35),{className:e}=n,[r,o]=u.useState(!1),{user:i}=q();let l;t[0]===Symbol.for("react.memo_cache_sentinel")?(l={resolver:U(we),defaultValues:{sentiment:"neutral"}},t[0]=l):l=t[0];const s=ee(l),[d,c]=he();let m,x;t[1]!==s||t[2]!==r?(m=()=>{r&&setTimeout(()=>{s.setFocus("feedback")},100)},x=[r,s],t[1]=s,t[2]=r,t[3]=m,t[4]=x):(m=t[3],x=t[4]),u.useEffect(m,x);let b;t[5]!==i?(b=async S=>{if(!i)throw new Error("You must be logged in to submit feedback");const{error:N}=await X.from("feedback").insert({content:S.feedback,sentiment:je[S.sentiment],user_id:i.id});if(N)throw N},t[5]=i,t[6]=b):b=t[6];let p;t[7]!==s?(p=()=>{B.success("Thank you for your feedback!"),s.reset(),o(!1)},t[7]=s,t[8]=p):p=t[8];let v;t[9]!==b||t[10]!==p?(v={mutationFn:b,onSuccess:p,onError:Ne},t[9]=b,t[10]=p,t[11]=v):v=t[11];const h=re(v);let E;t[12]!==h?(E=S=>{h.mutate(S)},t[12]=h,t[13]=E):E=t[13];const f=E;let g;t[14]!==e?(g=_("bg-secondary flex flex-col items-center justify-center transition-colors",e),t[14]=e,t[15]=g):g=t[15];let w;t[16]!==c.height||t[17]!==c.width?(w={height:c.height,width:c.width},t[16]=c.height,t[17]=c.width,t[18]=w):w=t[18];let C;t[19]===Symbol.for("react.memo_cache_sentinel")?(C={type:"spring",duration:.5},t[19]=C):C=t[19];let j;t[20]!==s||t[21]!==f||t[22]!==r||t[23]!==h.isPending?(j=r&&a.jsxs(R.div,{layout:!0,className:"space-y-4 p-4 [box-shadow:4px_4px_0_0_rgba(0,0,0,0.5)] dark:[box-shadow:4px_4px_0_0_rgba(255,255,255,0.5)]",exit:{opacity:0,filter:"blur(10px)"},animate:{opacity:1,filter:"blur(0px)"},transition:{type:"spring",duration:.8,bounce:.1},initial:{opacity:0,filter:"blur(10px)"},children:[a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Leave Feedback"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"We'd love to hear what went well or how we can improve entropretty."})]}),a.jsx(fe,{...s,children:a.jsxs("form",{onSubmit:s.handleSubmit(f),className:"space-y-4",children:[a.jsx(H,{control:s.control,name:"feedback",render:ke}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(H,{control:s.control,name:"sentiment",render:Fe}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx($,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),a.jsx($,{type:"submit",disabled:h.isPending,children:h.isPending?a.jsx(a.Fragment,{children:a.jsx(ae,{className:"mr-2 h-4 w-4 animate-spin"})}):"Submit"})]})]})]})})]},"feedback_form"),t[20]=s,t[21]=f,t[22]=r,t[23]=h.isPending,t[24]=j):j=t[24];let F;t[25]!==r?(F=!r&&a.jsx(R.div,{className:"shadow-none",animate:{opacity:1,filter:"blur(0px)"},exit:{opacity:0,filter:"blur(10px)"},transition:{type:"spring",duration:.1,bounce:.1},initial:{opacity:0,filter:"blur(10px)"},children:a.jsx($,{variant:"secondary",className:"[box-shadow:4px_4px_0_0_rgba(0,0,0,0.5)] dark:[box-shadow:4px_4px_0_0_rgba(255,255,255,0.5)]",onClick:()=>o(!0),children:"Feedback"})},"open_button"),t[25]=r,t[26]=F):F=t[26];let k;t[27]!==d||t[28]!==j||t[29]!==F?(k=a.jsx(se,{mode:"wait",children:a.jsxs("div",{ref:d,children:[j,F]})}),t[27]=d,t[28]=j,t[29]=F,t[30]=k):k=t[30];let L;return t[31]!==k||t[32]!==g||t[33]!==w?(L=a.jsx(R.div,{className:g,animate:w,transition:C,children:k}),t[31]=k,t[32]=g,t[33]=w,t[34]=L):L=t[34],L}function Fe(n){const{field:t}=n;return a.jsxs(M,{children:[a.jsx("div",{className:"flex gap-2",children:[{value:"negative",icon:ie},{value:"neutral",icon:de},{value:"positive",icon:ue}].map(e=>{const{value:r,icon:o}=e;return a.jsx(T,{children:a.jsx($,{type:"button",variant:t.value===r?"outline":"ghost",size:"icon",className:_(t.value===r&&"border-primary"),onClick:()=>t.onChange(r),children:a.jsx(o,{className:"h-4 w-4"})})},r)})}),a.jsx(O,{})]})}function ke(n){const{field:t}=n;return a.jsxs(M,{children:[a.jsx(T,{children:a.jsx(W,{placeholder:"Your feedback",className:"bg-background min-h-[100px]",...t})}),a.jsx(O,{})]})}function Ne(n){B.error(`Failed to submit feedback: ${n.message}`)}export{Ie as F,ae as L,H as a,fe as b,M as c,T as d,he as j};
