import{f as j,s as _,c as y,u as v,j as t,r as A}from"./main-D_QOtJ75.js";import{A as F,a as x}from"./AlgorithmCardSkeleton-BfKjjmlv.js";import{f as N,F as P}from"./FamilyKindFilter-B-AytEWE.js";import{u as S}from"./useInfiniteQuery-it1EuC-d.js";import{u as k}from"./react-R1SzaRUi.js";import{u as E}from"./index-DFufhFO-.js";import{F as b}from"./index-B8xx3lLY.js";import"./LikeButton-Bzkwyt-l.js";import"./button-BnWcWO71.js";import"./utils-CjfV1Qjd.js";import"./useUsersLikes-BZbDMPmT.js";import"./useQuery-tapXCO0W.js";import"./useBaseQuery-BJjxcAKU.js";import"./createLucideIcon-4ydf6LMZ.js";import"./AlgorithmInfo-4eJFaIHW.js";import"./FamilyKindBadge-rjTMkzGm.js";import"./AlgorithmBitmap-CUFHLwpA.js";import"./index-BzRZEjlo.js";import"./useDisplaySizes-DoYTHURn.js";import"./select-DPbtel31.js";import"./index-DRhfWXIf.js";import"./Combination-CimkD6oK.js";import"./index-CtIrN4Eb.js";import"./index-BG3MwORJ.js";import"./label-CqcMyrRf.js";import"./useMutation-DYqESHb7.js";import"./proxy-zRc3mXX4.js";const h=3;function w(){const e=j(),o=k(N);return S({queryKey:["algorithms","hot",o],initialPageParam:0,queryFn:async({pageParam:i})=>{const r=i*h,m=r+h-1;let n=_.from("algorithms_with_user_profile").select().order("like_count",{ascending:!1}).order("id",{ascending:!0}).gt("like_count",0);o!=="All"&&(n=n.eq("family_kind",o));const{data:s,error:a}=await n.range(r,m);if(s)for(const l of s)e.addAlgorithm(l.id,l.content,l.family_kind);if(a)throw a;return s},getNextPageParam:(i,r)=>i.length===h?r.length:void 0})}function q(){const e=y.c(18),{ref:o,inView:i}=E(),{data:r,isLoading:m,fetchNextPage:n,hasNextPage:s,isFetchingNextPage:a}=w();let l,d;if(e[0]!==n||e[1]!==s||e[2]!==i||e[3]!==a?(l=()=>{i&&s&&!a&&n()},d=[i,n,s,a],e[0]=n,e[1]=s,e[2]=i,e[3]=a,e[4]=l,e[5]=d):(l=e[4],d=e[5]),A.useEffect(l,d),m){let g;return e[6]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsxs("div",{className:"space-y-4",children:[t.jsx(x,{}),t.jsx(x,{})]}),e[6]=g):g=e[6],g}let c;e[7]!==r?.pages?(c=r?.pages.map(K),e[7]=r?.pages,e[8]=c):c=e[8];let p;e[9]!==s||e[10]!==a?(p=a?t.jsx("div",{children:"Loading more..."}):s?t.jsx("div",{children:"Load more"}):t.jsx("div",{children:"No more rated algorithms"}),e[9]=s,e[10]=a,e[11]=p):p=e[11];let f;e[12]!==o||e[13]!==p?(f=t.jsx("div",{ref:o,className:"py-4 text-center",children:p}),e[12]=o,e[13]=p,e[14]=f):f=e[14];let u;return e[15]!==c||e[16]!==f?(u=t.jsxs("div",{className:"space-y-4",children:[c,f]}),e[15]=c,e[16]=f,e[17]=u):u=e[17],u}function K(e){return e.map(C)}function C(e){return t.jsx(F,{algorithm:e},e.id)}function I(){const e=y.c(5),{user:o}=v();let i;e[0]!==o?(i=o&&t.jsx(b,{className:"fixed bottom-4 left-4 z-50"}),e[0]=o,e[1]=i):i=e[1];let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx("div",{className:"mx-auto my-4",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx(P,{}),t.jsx(q,{})]})}),e[2]=r):r=e[2];let m;return e[3]!==i?(m=t.jsxs(t.Fragment,{children:[i,r]}),e[3]=i,e[4]=m):m=e[4],m}const ne=I;export{ne as component};
