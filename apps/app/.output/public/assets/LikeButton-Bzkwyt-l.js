import{u as g,g as x,r as u,s as l,t as d,j as o}from"./main-D_QOtJ75.js";import{B as y}from"./button-BnWcWO71.js";import{u as L}from"./useUsersLikes-BZbDMPmT.js";import{c as h}from"./utils-CjfV1Qjd.js";import{c as b}from"./createLucideIcon-4ydf6LMZ.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],_=b("arrow-up",j);function Q({algorithm:e}){const{user:s}=g(),{data:m,isLoading:c}=L(),t=x(),n=m?.includes(e.id),k=u.useMemo(()=>e.like_count??0,[e]),p=u.useCallback(async()=>{if(!s)return;const i=["user-likes",s.id],a=t.getQueryData(i)??[];if(n){t.setQueryData(i,a.filter(f=>f!==e.id));const{error:r}=await l.from("likes").delete().eq("algorithm_id",e.id).eq("user_id",s.id);r&&(t.setQueryData(i,a),console.error("Error unliking algorithm:",r),d.error("Error Unliking Algorithm: "+r.message))}else{t.setQueryData(i,[...a,e.id]);const{error:r}=await l.from("likes").insert([{algorithm_id:e.id,user_id:s.id}]);r&&(t.setQueryData(i,a),console.error("Error liking algorithm:",r),d.error("Error Liking Algorithm: "+r.message))}},[e,s,t,n]);return c?null:o.jsx("div",{className:"flex flex-row items-center justify-center gap-2",children:o.jsxs(y,{variant:"ghost",onClick:p,className:h({"bg-brand-blue hover:bg-brand-blue/80 text-background":n,"pointer-events-none":!s||c}),children:[o.jsx(_,{className:"h-4 w-4",strokeLinecap:"square",strokeLinejoin:"miter"}),o.jsx("span",{className:"flex items-center gap-2",children:o.jsx("span",{className:"text-sm",children:k||0})})]})})}export{Q as L};
